-- JOIN THE TWO TABLES TOGETHER -- CREATE COUNTRY CODE, SORT CODE AND IBAN
SELECT 'GB' AS COUNTRY_CODE, REPLACE (SORT_CODE,'-','') AS SORTCODE,
CHECK_DIGITS, SWIFT_CODE, ACCOUNT_NUMBER, COUNTRY_CODE ||
CHECK_DIGITS::VARCHAR(20) || SWIFT_CODE || SORTCODE::VARCHAR(20) ||
ACCOUNT_NUMBER::VARCHAR(20) AS IBAN FROM PD2023_WK02_TRANSACTIONS AS T INNER
JOIN PD2023_WK02_SWIFT_CODES AS C ON T.BANK = C.BANK; -- CREATE TABLE WITH JUST
TRANSACTION ID AND NEW IBAN COLUMN. SELECT TRANSACTION_ID, 'GB' ||
CHECK_DIGITS::VARCHAR(20) || SWIFT_CODE || REPLACE
(SORT_CODE,'-','')::VARCHAR(20) || ACCOUNT_NUMBER::VARCHAR(20) AS IBAN, FROM
PD2023_WK02_TRANSACTIONS AS T INNER JOIN PD2023_WK02_SWIFT_CODES AS C ON T.BANK
= C.BANK;
