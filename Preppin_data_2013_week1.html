-- EDIT THE TRANSACTION CODE TO FIND THE BANK -- CHANGE 1 AND 2 TO ONLINE OR IN
PERSON -- CHANGE DATE TIME INTO DAY OF WEEK SELECT
SPLIT_PART(TRANSACTION_CODE,'-',1) AS BANK, CASE WHEN ONLINE_OR_IN_PERSON = 1
THEN 'ONLINE' WHEN ONLINE_OR_IN_PERSON = 2 THEN 'IN PERSON' END AS
ONLINE_IN_PERSON, DAYNAME(DATE(TRANSACTION_DATE,'dd/mm/yyyy hh24:mi:ss')) AS
DAY, * FROM PD2023_WK01; -- FIND THE TOTAL VALUE FOR EACH BANK SELECT
SPLIT_PART(TRANSACTION_CODE,'-',1) AS BANK, SUM(VALUE) AS TOTAL_VALUE FROM
PD2023_WK01 GROUP BY SPLIT_PART(TRANSACTION_CODE,'-',1); -- FIND THE TOTAL VALUE
BY BANK, DAY AND TYPE OF TRANSACTION SELECT SPLIT_PART(TRANSACTION_CODE,'-',1)
AS BANK, CASE WHEN ONLINE_OR_IN_PERSON = 1 THEN 'ONLINE' WHEN
ONLINE_OR_IN_PERSON = 2 THEN 'IN PERSON' END AS ONLINE_IN_PERSON,
DAYNAME(DATE(TRANSACTION_DATE,'dd/mm/yyyy hh24:mi:ss')) AS DAY, SUM(VALUE) AS
TOTAL_VALUE FROM PD2023_WK01 GROUP BY SPLIT_PART(TRANSACTION_CODE,'-',1),
ONLINE_IN_PERSON, DAY; -- FIND THE TOTAL VALUE GROUPED BY BANK AND CLIENT CODE
SELECT SPLIT_PART(TRANSACTION_CODE,'-',1) AS BANK, CUSTOMER_CODE, SUM(VALUE) AS
TOTAL_VALUE, FROM PD2023_WK01 GROUP BY BANK, CUSTOMER_CODE;
